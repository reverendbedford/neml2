<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NEML2: Solid Mechanics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/ams','[tex]/physics','[tex]/boldsymbol']
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','ams','physics','boldsymbol']
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NEML2<span id="projectnumber">&#160;1.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('solid-mechanics.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Solid Mechanics</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md21">Elasticity</a></li>
<li class="level1"><a href="#autotoc_md22">Plasticity (macroscale)</a><ul><li class="level2"><a href="#autotoc_md23">Consistent plasticity</a></li>
<li class="level2"><a href="#autotoc_md24">Viscoplasticity</a></li>
<li class="level2"><a href="#autotoc_md25">Effective stress</a></li>
<li class="level2"><a href="#autotoc_md26">Perfectly Plastic Yield function</a></li>
<li class="level2"><a href="#autotoc_md27">Isotropic hardening</a></li>
<li class="level2"><a href="#autotoc_md28">Kinematic hardening</a></li>
<li class="level2"><a href="#autotoc_md29">Back stress</a></li>
<li class="level2"><a href="#autotoc_md30">Mixed hardening</a></li>
<li class="level2"><a href="#autotoc_md31">Flow rules</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md32">Mixed stress/strain control</a></li>
<li class="level1"><a href="#autotoc_md33">Crystal plasticity</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2neml2_2neml2_2doc_2content_2physics_2solid__mechanics"></a></p>
<p>The solid mechanics physics module is a collection objects serving as building blocks for composing material models for solids. Each category of the material model is explained below, with both the mathematical formulations and example input files.</p>
<h1><a class="anchor" id="autotoc_md21"></a>
Elasticity</h1>
<p>Elasticity models describe the relationship between stress \( \boldsymbol{\sigma} \) and strain \( \boldsymbol{\varepsilon} \) without any history-dependent (internal) state variables. In general, the stress-strain relation can be written as</p>
<p class="formulaDsp">
\[
  \boldsymbol{\sigma} = \mathbb{C} : \boldsymbol{\varepsilon}
\]
</p>
<p>where \( \mathbb{C} \) is the fourth-order elasticity tensor. For linear isotropic elasticity, this relation can be simplified as</p>
<p class="formulaDsp">
\[
  \boldsymbol{\sigma} = 3 K \operatorname{vol} \boldsymbol{\varepsilon} + 2 G \operatorname{dev} \boldsymbol{\varepsilon}
\]
</p>
<p>where \( K \) is the bulk modulus, and \( G \) is the shear modulus.</p>
<p>Below is an example input file that defines a linear elasticity model.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [model]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    youngs_modulus = 100</div>
<div class="line">    poisson_ratio = 0.3</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md22"></a>
Plasticity (macroscale)</h1>
<p>Generally speaking, plasticity models describe (oftentimes irreversible and dissipative) history-dependent deformation of solid materials. The plastic deformation is governed by the plastic loading/unloading conditions (or more generally the Karush-Kuhn-Tucker conditions):</p>
<p class="formulaDsp">
\begin{align*}
  f^p \leq 0, \quad \dot{\gamma} \geq 0, \quad \dot{\gamma}f^p = 0, \\
\end{align*}
</p>
<p>where \( f^p \) is the yield function, and \( \gamma \) is the consistency parameter.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
Consistent plasticity</h2>
<p>Consistent plasticity refers to the family of (macroscale) plasticity models that solve the plastic loading/unloading conditions (or the KKT conditions) exactly (up to machine precision).</p>
<blockquote class="doxtable">
<p>&zwj;Consistent plasticity models are sometimes considered rate-independent. But that is a misnomer as rate sensitivity can be baked into the yield function definition in terms of the rates of the internal variables. </p>
</blockquote>
<p>Residual associated with the KKT conditions can be written as the Fischer-Burmeister complementarity condition</p>
<p class="formulaDsp">
\begin{align*}
  r = \dot{\gamma} - f^p - \sqrt{{\dot{\gamma}}^2 + {f^p}^2}.
\end{align*}
</p>
<p>This complementarity condition is implemented by the object <code>RateIndependentPlasticFlowConstraint</code>. A complete example input file for consistent plasticity is shown below, and the composition and possible modifications are explained in the following subsections.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [elastic_strain]</div>
<div class="line">    type = ElasticStrain</div>
<div class="line">  []</div>
<div class="line">  [elasticity]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    youngs_modulus = 1e5</div>
<div class="line">    poisson_ratio = 0.3</div>
<div class="line">  []</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = &#39;VONMISES&#39;</div>
<div class="line">    tensor = &#39;state/internal/S&#39;</div>
<div class="line">    invariant = &#39;state/internal/s&#39;</div>
<div class="line">  []</div>
<div class="line">  [yield_function]</div>
<div class="line">    type = YieldFunction</div>
<div class="line">    yield_stress = 1000</div>
<div class="line">  []</div>
<div class="line">  [flow]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;vonmises yield_function&#39;</div>
<div class="line">  []</div>
<div class="line">  [normality]</div>
<div class="line">    type = Normality</div>
<div class="line">    model = &#39;flow&#39;</div>
<div class="line">    function = &#39;state/internal/fp&#39;</div>
<div class="line">    from = &#39;state/internal/S&#39;</div>
<div class="line">    to = &#39;state/internal/NM&#39;</div>
<div class="line">  []</div>
<div class="line">  [Eprate]</div>
<div class="line">    type = AssociativePlasticFlow</div>
<div class="line">  []</div>
<div class="line">  [integrate_Ep]</div>
<div class="line">    type = SR2BackwardEulerTimeIntegration</div>
<div class="line">    variable = &#39;state/internal/Ep&#39;</div>
<div class="line">  []</div>
<div class="line">  [consistency]</div>
<div class="line">    type = RateIndependentPlasticFlowConstraint</div>
<div class="line">  []</div>
<div class="line">  [surface]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &quot;elastic_strain elasticity</div>
<div class="line">              vonmises yield_function normality Eprate</div>
<div class="line">              consistency integrate_Ep&quot;</div>
<div class="line">  []</div>
<div class="line">  [return_map]</div>
<div class="line">    type = ImplicitUpdate</div>
<div class="line">    implicit_model = &#39;surface&#39;</div>
<div class="line">    solver = &#39;newton&#39;</div>
<div class="line">  []</div>
<div class="line">  [model]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;return_map elastic_strain elasticity&#39;</div>
<div class="line">    additional_outputs = &#39;state/internal/Ep&#39;</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24"></a>
Viscoplasticity</h2>
<p>Viscoplasticity models regularize the KKT conditions by introducing approximations to the constraints. A widely adopted approximation is the Perzyna model where rate sensitivity is baked into the approximation following a power-law relation:</p>
<p class="formulaDsp">
\begin{align*}
  \dot{\gamma} = \left( \dfrac{\left&lt; f^p \right&gt;}{\eta} \right)^n,
\end{align*}
</p>
<p>where \( \eta \) is the reference stress and \( n \) is the power-law exponent.</p>
<p>The Perzyna model is implemented by the object <code>PerzynaPlasticFlowRate</code>. A complete example input file for viscoplasticity is shown below, and the composition and possible modifications are explained in the following subsections.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [elastic_strain]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = &#39;forces/E state/internal/Ep&#39;</div>
<div class="line">    to_var = &#39;state/internal/Ee&#39;</div>
<div class="line">    coefficients = &#39;1 -1&#39;</div>
<div class="line">  []</div>
<div class="line">  [elasticity]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    youngs_modulus = 1e5</div>
<div class="line">    poisson_ratio = 0.3</div>
<div class="line">  []</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = &#39;VONMISES&#39;</div>
<div class="line">    tensor = &#39;state/internal/S&#39;</div>
<div class="line">    invariant = &#39;state/internal/s&#39;</div>
<div class="line">  []</div>
<div class="line">  [yield_function]</div>
<div class="line">    type = YieldFunction</div>
<div class="line">    yield_stress = 5</div>
<div class="line">  []</div>
<div class="line">  [flow]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;vonmises yield_function&#39;</div>
<div class="line">  []</div>
<div class="line">  [normality]</div>
<div class="line">    type = Normality</div>
<div class="line">    model = &#39;flow&#39;</div>
<div class="line">    function = &#39;state/internal/fp&#39;</div>
<div class="line">    from = &#39;state/internal/S&#39;</div>
<div class="line">    to = &#39;state/internal/NM&#39;</div>
<div class="line">  []</div>
<div class="line">  [flow_rate]</div>
<div class="line">    type = PerzynaPlasticFlowRate</div>
<div class="line">    reference_stress = 100</div>
<div class="line">    exponent = 2</div>
<div class="line">  []</div>
<div class="line">  [Eprate]</div>
<div class="line">    type = AssociativePlasticFlow</div>
<div class="line">  []</div>
<div class="line">  [integrate_Ep]</div>
<div class="line">    type = SR2BackwardEulerTimeIntegration</div>
<div class="line">    variable = &#39;state/internal/Ep&#39;</div>
<div class="line">  []</div>
<div class="line">  [implicit_rate]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &quot;isoharden elastic_strain elasticity</div>
<div class="line">              vonmises yield_function flow_rate</div>
<div class="line">              normality Eprate integrate_Ep&quot;</div>
<div class="line">  []</div>
<div class="line">  [return_map]</div>
<div class="line">    type = ImplicitUpdate</div>
<div class="line">    implicit_model = &#39;implicit_rate&#39;</div>
<div class="line">    solver = &#39;newton&#39;</div>
<div class="line">  []</div>
<div class="line">  [model]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;return_map elastic_strain elasticity&#39;</div>
<div class="line">    additional_outputs = &#39;state/internal/Ep&#39;</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md25"></a>
Effective stress</h2>
<p>The effective stress is a measure of stress describing how the plastic deformation "flows". For example, the widely-used \( J_2 \) plasticity uses the von Mises stress as the stress measure, i.e.,</p>
<p class="formulaDsp">
\begin{align*}
  \bar{\sigma} &amp;= \sqrt{3 J_2}, \\
  J_2 &amp;= \frac{1}{2} \operatorname{dev} \boldsymbol{\sigma} : \operatorname{dev} \boldsymbol{\sigma}.
\end{align*}
</p>
<p>Commonly used stress measures are defined using <code>SR2Invariant</code>.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = <span class="stringliteral">&#39;VONMISES&#39;</span></div>
<div class="line">    tensor = <span class="stringliteral">&#39;state/internal/S&#39;</span></div>
<div class="line">    invariant = <span class="stringliteral">&#39;state/internal/s&#39;</span></div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md26"></a>
Perfectly Plastic Yield function</h2>
<p>For perfectly plastic materials, the yield function only depends on the effective stress and a constant yield stress, i.e., the envelope does not shrink or expand depending on the loading history.</p>
<p class="formulaDsp">
\begin{align*}
  f^p &amp;= \bar{\sigma} - \sigma_y.
\end{align*}
</p>
<p>Below is an example input file defining a perfectly plastic yield function with \( J_2 \) flow.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = <span class="stringliteral">&#39;VONMISES&#39;</span></div>
<div class="line">    tensor = <span class="stringliteral">&#39;state/internal/S&#39;</span></div>
<div class="line">    invariant = <span class="stringliteral">&#39;state/internal/s&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [yield_function]</div>
<div class="line">    type = YieldFunction</div>
<div class="line">    yield_stress = 5</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md27"></a>
Isotropic hardening</h2>
<p>The equivalent plastic strain \( \bar{\varepsilon}^p \) is a scalar-valued internal variable that can be introduced to control the shape of the yield function. The isotropic strain hardening \( k \) is controlled by the accumulated equivalent plastic strain, and enters the yield function as</p>
<p class="formulaDsp">
\begin{align*}
  f^p &amp;= \bar{\sigma} - \sigma_y - k(\bar{\varepsilon}^p).
\end{align*}
</p>
<p>Below is an example input file defining a yield function with \( J_2 \) flow and linear isotropic hardening.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = <span class="stringliteral">&#39;VONMISES&#39;</span></div>
<div class="line">    tensor = <span class="stringliteral">&#39;state/internal/S&#39;</span></div>
<div class="line">    invariant = <span class="stringliteral">&#39;state/internal/s&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [isoharden]</div>
<div class="line">    type = LinearIsotropicHardening</div>
<div class="line">    hardening_modulus = 1000</div>
<div class="line">  []</div>
<div class="line">  [yield_function]</div>
<div class="line">    type = YieldFunction</div>
<div class="line">    yield_stress = 5</div>
<div class="line">    isotropic_hardening = <span class="stringliteral">&#39;state/internal/k&#39;</span></div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md28"></a>
Kinematic hardening</h2>
<p>The kinematic plastic strain \( \boldsymbol{K}^p \) is a tensor-valued internal variable that can be introduced to control the shape of the yield function. The kinematic hardening \( X \) is controlled by the accumulated kinematic plastic strain, and the effective stress is defined in terms of the over stress. In case of \( J_2 \), the effective stress can be rewritten as</p>
<p class="formulaDsp">
\begin{align*}
  \bar{\sigma} &amp;= \sqrt{3 J_2}, \\
  J_2 &amp;= \frac{1}{2} \operatorname{dev} \boldsymbol{\Xi} : \operatorname{dev} \boldsymbol{\Xi}, \\
  \boldsymbol{\Xi} &amp;= \boldsymbol{\sigma} - \boldsymbol{X}.
\end{align*}
</p>
<p>Below is an example input file defining a yield function with \( J_2 \) flow and linear kinematic hardening.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [kinharden]</div>
<div class="line">    type = LinearKinematicHardening</div>
<div class="line">    hardening_modulus = 1000</div>
<div class="line">  []</div>
<div class="line">  [overstress]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = <span class="stringliteral">&#39;state/internal/S state/internal/X&#39;</span></div>
<div class="line">    to_var = <span class="stringliteral">&#39;state/internal/O&#39;</span></div>
<div class="line">    coefficients = <span class="stringliteral">&#39;1 -1&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = <span class="stringliteral">&#39;VONMISES&#39;</span></div>
<div class="line">    tensor = <span class="stringliteral">&#39;state/internal/O&#39;</span></div>
<div class="line">    invariant = <span class="stringliteral">&#39;state/internal/s&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [yield_function]</div>
<div class="line">    type = YieldFunction</div>
<div class="line">    yield_stress = 5</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md29"></a>
Back stress</h2>
<p>An alternative way of introducing hardening is through back stresses. Instead of modeling the accumulation of kinematic plastic strain, back stress models directly describe the evolution of back stress. An example input file defining a yield function with \( J_2 \) flow and two back stresses is shown below.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [overstress]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = <span class="stringliteral">&#39;state/internal/S state/internal/X1 state/internal/X2&#39;</span></div>
<div class="line">    to_var = <span class="stringliteral">&#39;state/internal/O&#39;</span></div>
<div class="line">    coefficients = <span class="stringliteral">&#39;1 -1 -1&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = <span class="stringliteral">&#39;VONMISES&#39;</span></div>
<div class="line">    tensor = <span class="stringliteral">&#39;state/internal/O&#39;</span></div>
<div class="line">    invariant = <span class="stringliteral">&#39;state/internal/s&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [yield_function]</div>
<div class="line">    type = YieldFunction</div>
<div class="line">    yield_stress = 5</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md30"></a>
Mixed hardening</h2>
<p>Isotropic hardening, kinematic hardening, and back stresses are all optional and can be "mixed" in the definition of a yield function. The example input file below shows a yield function with \( J_2 \) flow, isotropic hardening, kinematic hardening, and two back stresses.</p>
<div class="fragment"><div class="line">[Models]</div>
<div class="line">  [isoharden]</div>
<div class="line">    type = LinearIsotropicHardening</div>
<div class="line">    hardening_modulus = 1000</div>
<div class="line">  []</div>
<div class="line">  [kinharden]</div>
<div class="line">    type = LinearKinematicHardening</div>
<div class="line">    hardening_modulus = 1000</div>
<div class="line">    back_stress = <span class="stringliteral">&#39;state/internal/X0&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [overstress]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = <span class="stringliteral">&#39;state/internal/S state/internal/X0 state/internal/X1 state/internal/X2&#39;</span></div>
<div class="line">    to_var = <span class="stringliteral">&#39;state/internal/O&#39;</span></div>
<div class="line">    coefficients = <span class="stringliteral">&#39;1 -1 -1 -1&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [vonmises]</div>
<div class="line">    type = SR2Invariant</div>
<div class="line">    invariant_type = <span class="stringliteral">&#39;VONMISES&#39;</span></div>
<div class="line">    tensor = <span class="stringliteral">&#39;state/internal/O&#39;</span></div>
<div class="line">    invariant = <span class="stringliteral">&#39;state/internal/s&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [yield_function]</div>
<div class="line">    type = YieldFunction</div>
<div class="line">    yield_stress = 5</div>
<div class="line">    isotropic_hardening = <span class="stringliteral">&#39;state/internal/k&#39;</span></div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md31"></a>
Flow rules</h2>
<p>Flow rules are required to map from the consistency parameter \( \gamma \) to various internal variables describing the state of hardening, such as the equivalent plastic strain \( \bar{\varepsilon}^p \), the kinematic plastic strain \( \boldsymbol{K}^p \), and the back stress \( \boldsymbol{X} \).</p>
<p>Associative flow rules define flow directions variationally according to the principle of maximum dissipation, i.e.,</p>
<p class="formulaDsp">
\begin{align*}
  \dot{\boldsymbol{\varepsilon}}^p &amp;= \dot{\gamma} \dfrac{\partial f^p}{\partial \boldsymbol{\sigma}}, \\
  \dot{\bar{\varepsilon}}^p &amp;= -\dot{\gamma} \dfrac{\partial f^p}{\partial k}, \\
  \dot{\boldsymbol{K}}^p &amp;= \dot{\gamma} \dfrac{\partial f^p}{\partial \boldsymbol{X}}.
\end{align*}
</p>
<p>The example input file below defines associative \( J_2 \) flow rules</p>
<div class="fragment"><div class="line">  [flow]</div>
<div class="line">    ...</div>
<div class="line">  []</div>
<div class="line">  [normality]</div>
<div class="line">    type = Normality</div>
<div class="line">    model = <span class="stringliteral">&#39;flow&#39;</span></div>
<div class="line">    function = <span class="stringliteral">&#39;state/internal/fp&#39;</span></div>
<div class="line">    <span class="keyword">from</span> = <span class="stringliteral">&#39;state/internal/S state/internal/k state/internal/X&#39;</span></div>
<div class="line">    to = <span class="stringliteral">&#39;state/internal/NM state/internal/Nk state/internal/NX&#39;</span></div>
<div class="line">  []</div>
<div class="line">  [eprate]</div>
<div class="line">    type = AssociativeIsotropicPlasticHardening</div>
<div class="line">  []</div>
<div class="line">  [Kprate]</div>
<div class="line">    type = AssociativeKinematicPlasticHardening</div>
<div class="line">  []</div>
<div class="line">  [Eprate]</div>
<div class="line">    type = AssociativePlasticFlow</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><p>In the above example, a model named "normality" is used to compute the associative flow directions, and the rates of the internal variables are mapped using the rate of the consistency parameter and each of the associative flow direction. The cross-referenced model named "flow" (omitted in the example) is the composition of models defining the yield function \( f^p \) in terms of the variational arguments \( \boldsymbol{\sigma} \), \( k \), and \( \boldsymbol{X} \).</p>
<h1><a class="anchor" id="autotoc_md32"></a>
Mixed stress/strain control</h1>
<p>NEML2 models can be setup to take as input strain and provide stress or take as input stress and provide strain. With some additional work, a model that "natively" works in either strain or stress control can be modified to work under mixed stress/strain control.</p>
<p>Mixed control here means that some components of the strain tensor and some components of the stress tensor are provided as input and the model must solve for the conjugate, missing components of stress or strain.</p>
<p>Mathematically, at each time step consider a tensor of applied, mixed strain or stress conditions \( f_{ij}  \) and a control signal \( c_{ij} \). When \( c_{ij} &lt; h \) for some threshold \( h \) we consider the corresponding component of the input \( f_{ij} \) to be a strain value and the model must solve for the corresponding value of stress. If \( c_{ij} \ge h \) we consider the corresponding component of the input \( f_{ij} \) to be a stress value and the model must solve for the corresponding value of strain.</p>
<p>Modifying a model for mixed control only requires a few additional objects. The first maps from the mixed input and a conjugate mixed state vector into the actual model stress and strain input axes:</p>
<div class="fragment"><div class="line">[mixed]</div>
<div class="line">  type = MixedControlSetup</div>
<div class="line">[]</div>
<div class="line">[mixed_old]</div>
<div class="line">  type = MixedControlSetup</div>
<div class="line">  control = <span class="stringliteral">&quot;old_forces/control&quot;</span></div>
<div class="line">  mixed_state = <span class="stringliteral">&quot;old_state/mixed_state&quot;</span></div>
<div class="line">  fixed_values = <span class="stringliteral">&quot;old_forces/fixed_values&quot;</span></div>
<div class="line">  cauchy_stress = <span class="stringliteral">&quot;old_state/S&quot;</span></div>
<div class="line">  strain = <span class="stringliteral">&quot;old_forces/E&quot;</span></div>
<div class="line">[]</div>
</div><!-- fragment --><p>The second modification renames the resulting residual to map to the correct name for the mixed state:</p>
<div class="fragment"><div class="line">[rename]</div>
<div class="line">  type = CopySR2</div>
<div class="line">  <span class="keyword">from</span> = <span class="stringliteral">&quot;residual/S&quot;</span></div>
<div class="line">  to = <span class="stringliteral">&quot;residual/mixed_state&quot;</span></div>
<div class="line">[]</div>
</div><!-- fragment --><p>In this example the "base" model is setup for strain control, so that the residual is formed on stress. For "base" stress control the only change would be the name of the <code>from</code> parameter in this object.</p>
<p>These two modifications will allow the model to be run in mixed control. One additional modification clarifies the output by mapping the mixed input and state back to stress and strain tensors</p>
<div class="fragment"><div class="line">[mixed_output]</div>
<div class="line">  type = MixedControlSetup</div>
<div class="line">  cauchy_stress = <span class="stringliteral">&#39;output/stress&#39;</span></div>
<div class="line">  strain = <span class="stringliteral">&#39;output/strain&#39;</span></div>
<div class="line">[]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md33"></a>
Crystal plasticity</h1>
<p>NEML2 adopts an incremental rate-form view of crystal plasticity. The fundemental kinematics derive from the rate expansion of the elastic-plastic multiplactive split:</p>
<p class="formulaDsp">
\begin{align*}
  F = F^e F^p
\end{align*}
</p>
<p>where the spatial velocity gradient is then</p>
<p class="formulaDsp">
\begin{align*}
  l = \dot{F} F^{-1} = \dot{F}^e F^{e-1} + F^e \dot{F}^{p} {F}^{p-1} F^{e-1}
\end{align*}
</p>
<p>The plastic deformation \( \bar{l}^p = \dot{F}^{p} {F}^{p-1} \) defines the crystal plasticity kinemtics and NEML2 assumes that the elastic stretch is small ( \( F^e = \left(I + \varepsilon \right) R^e \)) so that spatial velocity gradient becomes</p>
<p class="formulaDsp">
\begin{align*}
  l =  \dot{\varepsilon} +  \Omega^e - \Omega^e \varepsilon + \varepsilon \Omega^e + l^p + \varepsilon l^p -  l^p \varepsilon
\end{align*}
</p>
<p>defining \( l^p = R^e \bar{l}^p R^{eT} \) as the constitutive plastic velocity gradient rotated into the current configuration and \( \Omega^e = \dot{R}^e R^{eT} \) as the elastic spin and assuming that</p>
<ol type="1">
<li>Terms quadratic in the elastic stretch ( \( \varepsilon\)) are small.</li>
<li>Terms quadratic in the rate of elastic stretch ( \( \dot{\varepsilon} \)) are also small.</li>
</ol>
<p>The first assumption is accurate for metal plasticity, the second assumption is more questionable if the material deforms at a fast strain rate.</p>
<p>Define the current orientation of a crystal as the composition of its initial rotation from the crystal system to the lab frame and the elastic rotation, i.e.</p>
<p class="formulaDsp">
\begin{align*}
  Q = R^e Q_0
\end{align*}
</p>
<p>and note with this defintion we can rewrite the spin equation:</p>
<p class="formulaDsp">
\begin{align*}
  \Omega^e = \dot{R}^e R^{eT} = \dot{Q} Q_0^T Q_0 Q^T = \dot{Q} Q^T
\end{align*}
</p>
<p>With this definition and the choice of kinematics above we can derive evolution equations for our fundemental constitutive quantities, the elastic stretch \( \varepsilon \) and the orientation $Q$ by splitting the spatial velocity gradient into symmetric and skew parts and rearranging the resulting equations:</p>
<p class="formulaDsp">
\begin{align*}
  \dot{\varepsilon}= d -d^p-\varepsilon w +  w \varepsilon \\
  \dot{Q} = \left(w - w^p - \varepsilon d^p + d^p \varepsilon\right) Q .
\end{align*}
</p>
<p>where \(l = d + w\) and \(l^p = d^p + w^p\)</p>
<p>For most (or all) choices of crystal plasticity constitutive models we also need to define the Cauchy stress as:  </p><p class="formulaDsp">
\begin{align*}
  \sigma = C : \varepsilon
\end{align*}
</p>
<p>with \( C \) a (generally) anisotropic crystal elasticity tensor rotated into the current configuration.</p>
<p>The crystal plasticity examples in NEML2 integrate the elastic strain (and the constitutive internal variables) using a backward Euler integration rule and integrate the crystal orientation using either an implicit or explicit exponential rule. These integrate rules can either be coupled or decoupled, i.e. integrated together in a fully implicit manner or first integrate the strain and internal variables and then sequentially integrating the rotations.</p>
<p>A full constitutive model must then define the plastic deformation $l^p$ and whatever internal variables are used in this definition. A wide variety of choices are possible, but the examples use the basic assumption of Asaro:</p>
<p class="formulaDsp">
\begin{align*}
  l^p = \sum_{i=1}^{n_{slip}} \dot{\gamma}_i Q \left(d_i \otimes n_i \right) Q^T
\end{align*}
</p>
<p>where now \( \dot{\gamma}_i \), the slip rate on each system, is the constitutive chioce. NEML provides a variety of options for defining these slip rates in terms of internal hardening variables and the results shear stress</p>
<p class="formulaDsp">
\begin{align*}
  \tau_i = \sigma : Q \operatorname{sym}\left(d_i \otimes n_i \right) Q^T
\end{align*}
</p>
<p>Ancillary classes automatically generate lists of slip and twin systems from the crystal sytem, so the user does not need to manually provide these themselves.</p>
<p>NEML2 uses <em>modified</em> Rodrigues parameters to define orientations internally. These can be converted to Euler angles, quaternions, etc. for output. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
